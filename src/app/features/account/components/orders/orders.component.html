<section class="orders-page bg-white py-5">
  <div class="container">
    <h4 class="fw-bold mb-3"> طلباتك
    </h4>

    <table class="table table-hover">
      <thead>
        <tr class="table-secondary">
          <th>طلب</th>
          <th>التاريخ</th>
          <th>عدد المنتجات</th>
          <th>حالة الطلب</th>
          <th>الاجمالى</th>
          <th>نشاط</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let cartItem of ordersList">
          <!-- Main Row -->
          <tr>
            <td class="align-middle">
              <button class="btn btn-sm btn-link p-0 me-2" (click)="toggleRow(cartItem.orderId)">
                <i class="fas" [ngClass]="{
                'fa-chevron-down': expandedOrderId === cartItem.orderId,
                'fa-chevron-right': expandedOrderId !== cartItem.orderId
              }"></i>
              </button>
              {{ cartItem.orderId }}
            </td>
            <td class="align-middle">
              {{ cartItem.orderDate.substring(0, 10) }}
            </td>
            <td class="align-middle">
              {{ cartItem.orderItems.length }}
            </td>
            <td class="align-middle">
              <span *ngIf="getStatusById(cartItem.orderStatus) as status" [ngClass]="status.class">
                {{ status.name }}
              </span>
            </td>

            <td class="align-middle">
              {{ cartItem.totalPrice }}
              <img src="../../../../assets/imgs/Saudi_Riyal.svg" alt="" class="ms-1"
                style="width: 20px; height: 20px;" />
            </td>
            <td class="align-middle">
              <div class="dropdown">
                <a class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="fas fa-ellipsis-v fa-fw"></i>
                </a>
                <ul class="dropdown-menu">
                  <!-- <li><a class="dropdown-item" href="#">عرض الطلب</a></li> -->
                  <li><a class="dropdown-item" href="#">تقييم الطلب</a></li>
                  <li><a class="dropdown-item" href="#">الغاء طلب</a></li>
                </ul>
              </div>
            </td>
          </tr>

          <!-- Expanded Row -->
          <tr *ngIf="expandedOrderId === cartItem.orderId">
            <td colspan="6" class="bg-light">
              <table class="table table-sm mb-0">
                <thead>
                  <tr>
                    <th>المنتج</th>
                    <th>الكمية</th>
                    <th>السعر</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of cartItem.orderItems">
                    <td>{{ item.productsId }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>{{ item.totalPrice }}</td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>

  </div>
</section>